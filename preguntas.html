<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Preguntas para Cami</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <style>
        /* ESTILOS SIMPLIFICADOS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100vw;
            height: 100vh;
            height: -webkit-fill-available;
            overflow: hidden;
            position: fixed;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        /* ANIMACIONES SUAVES */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* CONTENEDOR PRINCIPAL */
        .pantalla-preguntas {
            width: 100vw;
            height: 100vh;
            min-height: -webkit-fill-available;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .contenedor-preguntas {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 700px;
            width: 90%;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            animation: fadeIn 0.8s ease-out;
        }
        
        /* BARRA DE PROGRESO */
        .barra-progreso {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }
        
        .paso {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #666;
            z-index: 2;
            transition: all 0.3s;
        }
        
        .paso.activo {
            background: #764ba2;
            color: white;
            transform: scale(1.1);
        }
        
        .paso.completado {
            background: #4CAF50;
            color: white;
        }
        
        .linea-progreso {
            position: absolute;
            top: 50%;
            left: 17px;
            right: 17px;
            height: 3px;
            background: #e0e0e0;
            z-index: 1;
            transform: translateY(-50%);
        }
        
        .linea-activa {
            position: absolute;
            top: 50%;
            left: 17px;
            height: 3px;
            background: #4CAF50;
            z-index: 1;
            transform: translateY(-50%);
            transition: width 0.5s ease;
        }
        
        /* CONTENIDO DE PREGUNTAS */
        .contenido-pregunta {
            animation: fadeIn 0.5s ease;
        }
        
        .numero-pregunta {
            color: #764ba2;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .texto-pregunta {
            font-size: 22px;
            color: #333;
            margin-bottom: 25px;
            font-weight: 600;
            line-height: 1.4;
        }
        
        /* √ÅREA DE RESPUESTA */
        .area-respuesta {
            margin-bottom: 25px;
        }
        
        .respuesta-texto {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: border-color 0.3s;
        }
        
        .respuesta-texto:focus {
            border-color: #764ba2;
            outline: none;
        }
        
        .opciones-si-no {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .opcion-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #764ba2;
            background: white;
            color: #764ba2;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .opcion-btn:hover {
            background: #f0e6ff;
        }
        
        .opcion-btn.seleccionado {
            background: #764ba2;
            color: white;
        }
        
        /* BOTONES DE NAVEGACI√ìN */
        .botones-navegacion {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn-navegacion {
            padding: 12px 25px;
            background: #764ba2;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-navegacion:hover {
            background: #5a3890;
            transform: translateY(-2px);
        }
        
        .btn-navegacion:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-finalizar {
            background: #4CAF50;
            animation: pulse 2s infinite;
        }
        
        .btn-finalizar:hover {
            background: #45a049;
        }
        
        /* MENSAJE DE ENV√çO */
        .mensaje-envio {
            background: #e8f5e9;
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            display: none;
            animation: fadeIn 0.5s ease;
            text-align: center;
        }
        
        .mensaje-envio.visible {
            display: block;
        }
        
        .cargando {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #764ba2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-continuar-final {
            background: #25D366;
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .btn-continuar-final:hover {
            background: #128C7E;
            transform: translateY(-2px);
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .contenedor-preguntas {
                padding: 20px;
            }
            
            .texto-pregunta {
                font-size: 20px;
            }
            
            .opciones-si-no {
                flex-direction: column;
            }
            
            .botones-navegacion {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn-navegacion {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="pantalla-preguntas">
        <div class="contenedor-preguntas">
            <!-- Barra de progreso -->
            <div class="barra-progreso" id="barraProgreso">
                <div class="linea-progreso"></div>
                <div class="linea-activa" id="lineaActiva"></div>
                <!-- Los pasos se generan din√°micamente -->
            </div>
            
            <!-- Contenedor de preguntas -->
            <div id="contenedorPreguntas">
                <!-- Las preguntas se cargar√°n aqu√≠ din√°micamente -->
            </div>
            
            <!-- Mensaje de env√≠o autom√°tico -->
            <div class="mensaje-envio" id="mensajeEnvio">
                <h3 style="color: #2e7d32; margin-bottom: 15px;">
                    <i class="fas fa-check-circle"></i> ¬°Respuestas enviadas!
                </h3>
                <p style="margin-bottom: 15px;">
                    Tus respuestas se han enviado autom√°ticamente a Salom√≥n. ¬°Gracias por responder!
                </p>
                <div class="cargando" id="cargandoEnvio">
                    <div class="spinner"></div>
                    <span>Enviando respuestas...</span>
                </div>
                <button class="btn-continuar-final" id="btnContinuarFinal" style="display: none;">
                    <i class="fas fa-arrow-right"></i> Continuar a la invitaci√≥n
                </button>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // CONFIGURACI√ìN
        // =============================================
        const CONFIG = {
            TU_WHATSAPP: "584143568666",  // Tu n√∫mero para recibir respuestas
            TU_NOMBRE: "Salom√≥n",
            SU_NOMBRE: "Cami",
            ENVIAR_AUTOMATICAMENTE: true, // TRUE para enviar autom√°ticamente
            WEBSITE_URL: window.location.origin // URL actual para identificar
        };
        
        // =============================================
        // DATOS DE LAS PREGUNTAS
        // =============================================
        const PREGUNTAS = [
            {
                id: 1,
                texto: "¬øQu√© te ha parecido hasta los momentos mi existencia en tu vida?",
                tipo: "texto",
                respuesta: "",
                placeholder: "Escribe tu respuesta aqu√≠..."
            },
            {
                id: 2,
                texto: "¬øMe vas a terminar de pasar tu Curriculum alg√∫n d√≠a?",
                tipo: "si_no",
                opciones: ["S√≠", "No"],
                respuesta: ""
            },
            {
                id: 3,
                texto: "¬øAlg√∫n d√≠a ver√© el casting?",
                tipo: "si_no",
                opciones: ["S√≠", "No"],
                respuesta: ""
            },
            {
                id: 4,
                texto: "¬øCu√°ndo me invitas a una colaboraci√≥n en TikTok?",
                tipo: "texto",
                respuesta: "",
                placeholder: "Ej: Cuando quieras, la pr√≥xima semana, etc..."
            },
            {
                id: 5,
                texto: "¬øMe vas a explicar qu√≠mica?",
                tipo: "si_no",
                opciones: ["S√≠", "No"],
                respuesta: ""
            }
        ];
        
        // =============================================
        // VARIABLES GLOBALES
        // =============================================
        let preguntaActual = 0;
        let respuestasEnviadas = false;
        const respuestas = [];
        
        // =============================================
        // FUNCIONES PRINCIPALES
        // =============================================
        
        // Inicializar la aplicaci√≥n
        function inicializarApp() {
            console.log("Iniciando cuestionario para:", CONFIG.SU_NOMBRE);
            
            // Crear barra de progreso
            crearBarraProgreso();
            
            // Mostrar primera pregunta
            mostrarPregunta();
            
            // Configurar eventos globales
            configurarEventos();
        }
        
        // Crear barra de progreso din√°mica
        function crearBarraProgreso() {
            const barra = document.getElementById('barraProgreso');
            const lineaActiva = document.getElementById('lineaActiva');
            
            // Crear pasos
            PREGUNTAS.forEach((pregunta, index) => {
                const paso = document.createElement('div');
                paso.className = 'paso';
                paso.id = `paso${index + 1}`;
                paso.textContent = index + 1;
                barra.insertBefore(paso, lineaActiva);
            });
            
            // Actualizar progreso inicial
            actualizarBarraProgreso();
        }
        
        // Actualizar barra de progreso
        function actualizarBarraProgreso() {
            const porcentaje = (preguntaActual / (PREGUNTAS.length - 1)) * 100;
            document.getElementById('lineaActiva').style.width = `${porcentaje}%`;
            
            // Actualizar estado de pasos
            PREGUNTAS.forEach((pregunta, index) => {
                const paso = document.getElementById(`paso${index + 1}`);
                if (index < preguntaActual) {
                    paso.className = 'paso completado';
                } else if (index === preguntaActual) {
                    paso.className = 'paso activo';
                } else {
                    paso.className = 'paso';
                }
            });
        }
        
        // Mostrar pregunta actual
        function mostrarPregunta() {
            const pregunta = PREGUNTAS[preguntaActual];
            const contenedor = document.getElementById('contenedorPreguntas');
            
            let html = `
                <div class="contenido-pregunta">
                    <div class="numero-pregunta">
                        <i class="fas fa-question-circle"></i>
                        Pregunta ${preguntaActual + 1} de ${PREGUNTAS.length}
                    </div>
                    
                    <div class="texto-pregunta">${pregunta.texto}</div>
                    
                    <div class="area-respuesta" id="areaRespuesta">
            `;
            
            if (pregunta.tipo === 'texto') {
                html += `
                    <textarea class="respuesta-texto" 
                              id="respuestaTexto" 
                              placeholder="${pregunta.placeholder || 'Escribe tu respuesta aqu√≠...'}"
                              oninput="actualizarRespuestaTexto(this.value)">${pregunta.respuesta || ''}</textarea>
                `;
            } else if (pregunta.tipo === 'si_no') {
                html += `
                    <div class="opciones-si-no">
                        ${pregunta.opciones.map(opcion => `
                            <button class="opcion-btn ${pregunta.respuesta === opcion ? 'seleccionado' : ''}"
                                    onclick="seleccionarOpcion('${opcion}')">
                                ${opcion}
                            </button>
                        `).join('')}
                    </div>
                `;
            }
            
            html += `
                    </div>
                    
                    <div class="botones-navegacion">
                        ${preguntaActual > 0 ? `
                            <button class="btn-navegacion" onclick="preguntaAnterior()">
                                <i class="fas fa-arrow-left"></i> Anterior
                            </button>
                        ` : '<div></div>'}
                        
                        <button class="btn-navegacion ${preguntaActual === PREGUNTAS.length - 1 ? 'btn-finalizar' : ''}" 
                                id="btnSiguiente"
                                onclick="${preguntaActual === PREGUNTAS.length - 1 ? 'finalizarCuestionario()' : 'siguientePregunta()'}"
                                ${!pregunta.respuesta ? 'disabled' : ''}>
                            ${preguntaActual === PREGUNTAS.length - 1 ? 'Finalizar' : 'Siguiente'}
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            `;
            
            contenedor.innerHTML = html;
            actualizarBarraProgreso();
            
            // Enfocar el textarea si es de tipo texto
            if (pregunta.tipo === 'texto' && !pregunta.respuesta) {
                setTimeout(() => {
                    document.getElementById('respuestaTexto').focus();
                }, 100);
            }
        }
        
        // Actualizar respuesta de texto
        function actualizarRespuestaTexto(valor) {
            PREGUNTAS[preguntaActual].respuesta = valor.trim();
            const btnSiguiente = document.getElementById('btnSiguiente');
            btnSiguiente.disabled = !valor.trim();
        }
        
        // Seleccionar opci√≥n S√≠/No
        function seleccionarOpcion(opcion) {
            PREGUNTAS[preguntaActual].respuesta = opcion;
            
            // Actualizar botones
            document.querySelectorAll('.opcion-btn').forEach(btn => {
                btn.classList.remove('seleccionado');
                if (btn.textContent.trim() === opcion) {
                    btn.classList.add('seleccionado');
                }
            });
            
            document.getElementById('btnSiguiente').disabled = false;
        }
        
        // Navegaci√≥n entre preguntas
        function siguientePregunta() {
            if (preguntaActual < PREGUNTAS.length - 1) {
                preguntaActual++;
                mostrarPregunta();
            }
        }
        
        function preguntaAnterior() {
            if (preguntaActual > 0) {
                preguntaActual--;
                mostrarPregunta();
            }
        }
        
        // =============================================
        // ENV√çO AUTOM√ÅTICO DE RESPUESTAS
        // =============================================
        
        // Finalizar cuestionario y enviar respuestas
        async function finalizarCuestionario() {
            // Verificar que todas est√©n respondidas
            const sinResponder = PREGUNTAS.filter(p => !p.respuesta);
            
            if (sinResponder.length > 0) {
                alert('Por favor, responde todas las preguntas antes de finalizar.');
                preguntaActual = sinResponder[0].id - 1;
                mostrarPregunta();
                return;
            }
            
            // Mostrar mensaje de env√≠o
            mostrarMensajeEnvio();
            
            // Enviar respuestas autom√°ticamente
            const exito = await enviarRespuestasAutomaticamente();
            
            if (exito) {
                // Guardar en localStorage
                guardarRespuestasLocalmente();
                
                // Mostrar bot√≥n para continuar
                mostrarBotonContinuar();
            } else {
                // Si falla el env√≠o autom√°tico, mostrar opci√≥n manual
                mostrarOpcionManual();
            }
        }
        
        // Mostrar mensaje de env√≠o
        function mostrarMensajeEnvio() {
            const mensajeEnvio = document.getElementById('mensajeEnvio');
            const contenedorPreguntas = document.getElementById('contenedorPreguntas');
            
            contenedorPreguntas.style.display = 'none';
            mensajeEnvio.classList.add('visible');
        }
        
        // Enviar respuestas autom√°ticamente
        async function enviarRespuestasAutomaticamente() {
            try {
                // Crear mensaje con las respuestas
                let mensaje = `üìã *RESPUESTAS DE ${CONFIG.SU_NOMBRE.toUpperCase()}*\n\n`;
                
                PREGUNTAS.forEach((pregunta, index) => {
                    mensaje += `*${index + 1}. ${pregunta.texto}*\n`;
                    mensaje += `‚û§ ${pregunta.respuesta}\n\n`;
                });
                
                mensaje += `---\n`;
                mensaje += `Enviado desde: ${CONFIG.WEBSITE_URL}\n`;
                mensaje += `Fecha: ${new Date().toLocaleString('es-ES')}`;
                
                // Preparar datos para enviar
                const datos = {
                    telefono: CONFIG.TU_WHATSAPP,
                    mensaje: mensaje,
                    respuestas: PREGUNTAS.map(p => ({
                        pregunta: p.texto,
                        respuesta: p.respuesta
                    })),
                    timestamp: new Date().toISOString()
                };
                
                console.log("Enviando respuestas:", datos);
                
                // INTENTAR ENVIAR POR DIFERENTES M√âTODOS
                
                // M√©todo 1: Webhook (si configuras uno)
                // const resultado1 = await enviarPorWebhook(datos);
                // if (resultado1) return true;
                
                // M√©todo 2: EmailJS (gratis)
                // const resultado2 = await enviarPorEmailJS(datos);
                // if (resultado2) return true;
                
                // M√©todo 3: Formspree (gratis)
                const resultado3 = await enviarPorFormspree(datos);
                if (resultado3) return true;
                
                // Si todo falla, usar m√©todo de respaldo
                return await usarMetodoRespaldo(datos);
                
            } catch (error) {
                console.error("Error al enviar respuestas:", error);
                return false;
            }
        }
        
        // M√©todo 1: Enviar por Formspree (GRATIS y f√°cil)
        async function enviarPorFormspree(datos) {
            try {
                // Crear formulario virtual
                const formData = new FormData();
                formData.append('nombre', CONFIG.SU_NOMBRE);
                formData.append('telefono', CONFIG.TU_WHATSAPP);
                formData.append('mensaje', datos.mensaje);
                formData.append('timestamp', datos.timestamp);
                
                // Tu formulario Formspree (c√°mbialo por el tuyo)
                const FORMSPREE_URL = 'https://formspree.io/f/xjvqbzjg'; // REEMPLAZA ESTO
                
                const respuesta = await fetch(FORMSPREE_URL, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (respuesta.ok) {
                    console.log("Respuestas enviadas por Formspree");
                    return true;
                }
            } catch (error) {
                console.log("Formspree no disponible:", error);
            }
            return false;
        }
        
        // M√©todo de respaldo: Guardar y mostrar WhatsApp
        async function usarMetodoRespaldo(datos) {
            // Guardar localmente por si acaso
            localStorage.setItem('respuestas_backup', JSON.stringify(datos));
            
            // Crear enlace de WhatsApp con respuestas
            const mensajeCodificado = encodeURIComponent(datos.mensaje);
            const enlaceWhatsApp = `https://wa.me/${CONFIG.TU_WHATSAPP}?text=${mensajeCodificado}`;
            
            // Guardar enlace para uso posterior
            sessionStorage.setItem('whatsapp_link', enlaceWhatsApp);
            
            // Enviar despu√©s de 2 segundos (simulado)
            setTimeout(() => {
                window.open(enlaceWhatsApp, '_blank');
            }, 2000);
            
            return true;
        }
        
        // Guardar respuestas localmente
        function guardarRespuestasLocalmente() {
            const datos = {
                preguntas: PREGUNTAS,
                fecha: new Date().toISOString(),
                completado: true
            };
            
            localStorage.setItem('cuestionario_completado', JSON.stringify(datos));
            console.log("Respuestas guardadas localmente");
        }
        
        // Mostrar bot√≥n para continuar
        function mostrarBotonContinuar() {
            const cargando = document.getElementById('cargandoEnvio');
            const btnContinuar = document.getElementById('btnContinuarFinal');
            
            setTimeout(() => {
                cargando.style.display = 'none';
                btnContinuar.style.display = 'inline-flex';
            }, 1500);
        }
        
        // Mostrar opci√≥n manual si falla el env√≠o
        function mostrarOpcionManual() {
            const cargando = document.getElementById('cargandoEnvio');
            cargando.innerHTML = `
                <div style="text-align: center; color: #d32f2f;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 10px;"></i>
                    <p>No se pudo enviar autom√°ticamente.</p>
                    <button onclick="abrirWhatsAppManual()" 
                            style="background: #25D366; color: white; border: none; padding: 10px 20px; border-radius: 8px; margin-top: 10px; cursor: pointer;">
                        <i class="fab fa-whatsapp"></i> Enviar por WhatsApp
                    </button>
                </div>
            `;
        }
        
        // Abrir WhatsApp manualmente
        function abrirWhatsAppManual() {
            // Crear mensaje manual
            let mensaje = `üìã *RESPUESTAS DE ${CONFIG.SU_NOMBRE.toUpperCase()}*\n\n`;
            
            PREGUNTAS.forEach((pregunta, index) => {
                mensaje += `*${index + 1}. ${pregunta.texto}*\n`;
                mensaje += `‚û§ ${pregunta.respuesta}\n\n`;
            });
            
            const mensajeCodificado = encodeURIComponent(mensaje);
            const enlaceWhatsApp = `https://wa.me/${CONFIG.TU_WHATSAPP}?text=${mensajeCodificado}`;
            
            window.open(enlaceWhatsApp, '_blank');
        }
        
        // Configurar eventos
        function configurarEventos() {
            // Bot√≥n para continuar a la invitaci√≥n final
            document.getElementById('btnContinuarFinal').addEventListener('click', function() {
                window.location.href = "invitacion.html";
            });
            
            // Guardar progreso al salir
            window.addEventListener('beforeunload', function(e) {
                if (!localStorage.getItem('cuestionario_completado')) {
                    const progreso = PREGUNTAS.filter(p => p.respuesta).length;
                    if (progreso > 0) {
                        localStorage.setItem('progreso_cuestionario', JSON.stringify({
                            preguntaActual: preguntaActual,
                            respuestas: PREGUNTAS.map(p => p.respuesta),
                            fecha: new Date().toISOString()
                        }));
                    }
                }
            });
            
            // Cargar progreso guardado
            cargarProgresoGuardado();
        }
        
        // Cargar progreso guardado
        function cargarProgresoGuardado() {
            const guardado = localStorage.getItem('progreso_cuestionario');
            if (guardado) {
                try {
                    const datos = JSON.parse(guardado);
                    if (datos.respuestas && datos.respuestas.length === PREGUNTAS.length) {
                        PREGUNTAS.forEach((pregunta, index) => {
                            if (datos.respuestas[index]) {
                                pregunta.respuesta = datos.respuestas[index];
                            }
                        });
                        preguntaActual = datos.preguntaActual || 0;
                        mostrarPregunta();
                    }
                } catch (error) {
                    console.log("Error al cargar progreso:", error);
                }
            }
        }
        
        // =============================================
        // INICIALIZAR AL CARGAR LA P√ÅGINA
        // =============================================
        document.addEventListener('DOMContentLoaded', inicializarApp);
    </script>
</body>
</html>
